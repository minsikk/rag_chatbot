<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>RAG 챗봇 예제</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 50px; background-color: #f4f4f9; }
        h2 { color: #333; }
        #chat-container { max-width: 500px; margin-top: 20px; padding: 20px; background-color: #fff; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        #question-input { display: flex; gap: 10px; margin-bottom: 15px; }
        input#question { flex: 1; padding: 10px; border-radius: 8px; border: 1px solid #ccc; font-size: 16px; }
        button { padding: 10px 20px; border-radius: 8px; border: none; background-color: #4CAF50; color: white; font-size: 16px; cursor: pointer; }
        button:hover { background-color: #45a049; }
        #chat-history { max-height: 400px; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .message { padding: 10px 15px; border-radius: 8px; max-width: 80%; }
        .user { align-self: flex-end; background-color: #DCF8C6; }
        .bot { align-self: flex-start; background-color: #EEF; }
    </style>
</head>
<body>

<h2>RAG 챗봇 예제</h2>

<div id="chat-container">
    <div id="chat-history"></div>
    <div id="question-input">
        <input id="question" placeholder="질문을 입력하세요">
        <button onclick="sendQuestion()">전송</button>
    </div>
</div>

<script>
async function sendQuestion() {
    try {
        const inputEl = document.getElementById("question");
        const question = inputEl.value.trim();
        if (!question) return;

        addMessage(question, "user");
        inputEl.value = "";

        const res = await fetch("/chat/", {  // 그대로 /chat/ 유지
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify({question})
        });
        const data = await res.json();
        addMessage(data.answer ?? "응답이 없습니다.", "bot");
    } catch (err) {
        console.error(err);
        addMessage("서버 요청 실패", "bot");
    }
}

function addMessage(text, sender) {
    const msgEl = document.createElement("div");
    msgEl.classList.add("message", sender);
    msgEl.innerText = text;
    const historyEl = document.getElementById("chat-history");
    historyEl.appendChild(msgEl);
    historyEl.scrollTop = historyEl.scrollHeight;
}
</script>

</body>
</html>
